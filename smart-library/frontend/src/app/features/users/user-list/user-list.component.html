<div class="min-h-screen bg-gray-50 py-8 px-4 sm:px-6 lg:px-8">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <div class="max-w-7xl mx-auto">
    <p-card>
      <ng-template pTemplate="header">
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-4">
              <p-button
                icon="pi pi-arrow-left"
                [text]="true"
                [rounded]="true"
                severity="secondary"
                (onClick)="goToDashboard()"
                pTooltip="Back to Dashboard"
                tooltipPosition="bottom"
                styleClass="p-button-lg"
              ></p-button>
              <div>
                <h2 class="text-2xl font-bold text-gray-900">User Management</h2>
                <p class="text-sm text-gray-600 mt-1">Manage all registered users in the system</p>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-12 gap-3 items-end">
            <div class="md:col-span-4">
              <label for="roleFilter" class="block text-sm font-semibold text-gray-700 mb-2">Filter by Role</label>
              <p-select
                id="roleFilter"
                [(ngModel)]="selectedRole"
                [options]="roleOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="Select a role"
                (onChange)="onRoleFilterChange()"
                styleClass="w-full"
              />
            </div>
            <div class="md:col-span-8 flex justify-end">
              <p-button
                label="Show All Users"
                icon="pi pi-refresh"
                (onClick)="selectedRole = null; loadUsers()"
                severity="secondary"
                [text]="true"
              ></p-button>
            </div>
          </div>
        </div>
      </ng-template>

      <div class="p-6">
        <p-table
          [value]="users"
          [loading]="loading"
          [paginator]="true"
          [rows]="10"
          [showCurrentPageReport]="true"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} users"
          [rowsPerPageOptions]="[10, 25, 50]"
          styleClass="p-datatable-striped"
          [tableStyle]="{'min-width': '50rem'}"
        >
          <ng-template pTemplate="header">
            <tr>
              <th class="font-semibold" style="width: 25%">Name</th>
              <th class="font-semibold" style="width: 30%">Email</th>
              <th class="font-semibold" style="width: 15%">Role</th>
              <th class="font-semibold" style="width: 20%">Created At</th>
              <th class="font-semibold text-center" style="width: 10%">Actions</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-user>
            <tr>
              <td class="font-medium">{{ user.name }}</td>
              <td>{{ user.email }}</td>
              <td>
                <p-tag
                  [value]="user.role.toUpperCase()"
                  [severity]="getRoleSeverity(user.role)"
                  styleClass="font-semibold"
                ></p-tag>
              </td>
              <td>{{ user.createdAt | date: 'MMM d, y, h:mm a' }}</td>
              <td>
                <div class="flex gap-2 justify-center">
                  <p-button
                    icon="pi pi-eye"
                    [rounded]="true"
                    [text]="true"
                    severity="info"
                    (onClick)="viewProfile(user)"
                    pTooltip="View Profile"
                  ></p-button>

                  <p-button
                    icon="pi pi-trash"
                    [rounded]="true"
                    [text]="true"
                    severity="danger"
                    (onClick)="deleteUser(user)"
                    pTooltip="Delete"
                  ></p-button>
                </div>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5" class="text-center py-8">
                <i class="pi pi-users text-gray-400 text-5xl mb-3 block"></i>
                <p class="text-gray-600 text-lg">No users found.</p>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-card>
  </div>
</div>
